@(conversation: Conversation, websocketUri: String, content: String, messages: List[Message])
@import helper._
@main(conversation.getProject().getName() + " - " + conversation.getTitle()) {
<script type="text/javascript">
	@if(content.isEmpty()) { 
		var content = ""
	} else {
		var content = @Html(content);
	}
	var messagesCount = @messages.size();
	var messages = [];
	@for(message <- messages) {
		messages[@message.getPosition()] = {id:"@message.getId()",position:@message.getPosition(),content:"@Html(message.getContent())"};
	}
	websocketUri = "@websocketUri";
</script>
<div id="main-div" data-author="@conversation.getProject().getCreator().getUsername"
				   data-route-save-topic="@routes.Conversations.update(conversation.getProject().getCreator().getUsername(), conversation.getProject().getName(), conversation.getCleanTitle())">
	<section>
		<header>
			<a href="@routes.Projects.show(conversation.getProject().getCreator().getUsername(), conversation.getProject().getName())" title="@conversation.getProject().getName()">&nbsp;<i class="icon-arrow-left"> </i> <span class="bold">@conversation.getProject().getName()</span></a>
			<h1 class="green">@conversation.getTitle()</h1>
		</header>
		<article class="conversation-content">
			<div class="topic">
				<div id="wmd-topic" style="display: none;">
			        <div class="wmd-panel">
			            <div id="wmd-button-bar-topic"></div>
			            <textarea class="wmd-input" id="wmd-input-topic" style="width: 100%;">
						</textarea>
			        </div>
	 		    </div>
		        <div id="wmd-preview-topic" class="wmd-panel wmd-preview"></div>
		        <div class="text-right">
					<button id="save-topic" style="display: none;">
						Save
					</button>
					<button id="edit-topic">
						Edit
					</button>
				</div>
			<div>
			<br />
			<div class="topic-message-container">
				<div class="topic-message topic-message-prototype" style="display: none;" data-id="__id__">
					<div id="wmd-__id__" style="display: none;">
				        <div class="wmd-panel">
				            <div id="wmd-button-bar-__id__"></div>
				            <textarea class="wmd-input" id="wmd-input-__id__" style="width: 100%;">
							</textarea>
				        </div>
		 		    </div>
			        <div id="wmd-preview-__id__" class="wmd-panel wmd-preview"></div>
			        <div class="text-right">
						<button id="save-__id__" style="display: none;">
							Save
						</button>
						<button id="edit-__id__">
							Edit
						</button>
					</div>
				</div>
			</div>
			<br />
			<div class="topic-message">
				<div class="conversation-add-message" id="conversation-add-message">
					<span class="light-gray text-center">Click here to comment on this conversation.</span>
				</div>
			</div>
			</article>
		<footer>
		</footer>
	</section>
</div>
@helper.requireJs(core = routes.Assets.at("javascripts/require.js").url, module = routes.Assets.at("javascripts/conversations").url)
}
